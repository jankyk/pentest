input {
   syslog {
      type => sonicwall
      port => 5515
   }
}
filter {
   if [type] == "sonicwall" {
      kv {
         exclude_keys => [ "c", "id", "m", "n", "pri" ]
      }
      grok {
         match => { "message" => 'id=%{HOSTNAME:syslogid}' }
      }
      grok {
         match => [ "src", "%{IP:srcip}:%{DATA:srcinfo}" ]
      }
      grok {
         match => [ "dst", "%{IP:dstip}:%{DATA:dstinfo}" ]
      }
      grok {
         remove_field => [ "srcinfo", "dstinfo" ]
      }
      grok {
         match => { "message" => '(?<vpnpolicy>\VPN Policy: [a-zA-Z0-9 -]+)' }
      }
      grok {
         match => { "message" => '(?<vpnpolicy>\VPN-[a-zA-Z0-9-]+)' }
      }
      grok {
         match => { "Category" => '(?<productivity>[a-zA-Z -/()]+)' }
      }
      grok {
         match => { "msg" => '(?<countryname>Country Name:[a-zA-Z0-9 -]+)' }
      }
      grok {
         match => { "src" => '(?<srcinterface>:[XWT][a-zA-Z0-9 -]+)' }
      }
      grok {
         match => { "dst" => '(?<dstinterface>:[XWT][a-zA-Z0-9 -]+)' }
      }
      grok {
         match => { "src" => '(?<srcport>:[0-9]+)' }
      }
      grok {
         match => { "dst" => '(?<dstport>:[0-9]+)' }
      }
      grok {
         match => { "msg" => '(?<gavid>Cloud Id: [0-9]+)' }
      }
      grok {
         match => { "msg" => '(?<gavname>[A-Za-z0-9._]+ \([A-Za-z]+\) blocked.)' }
      }
      geoip {
         source => "srcip"
         target => "srcgeoip"
      }
      geoip {
         source => "dstip"
         target => "dstgeoip"
      }
      mutate {
         gsub => [
            "gavname", " blocked.", ""
         ]
         gsub => [
            "vpnpolicy", "VPN Policy: ", ""
         ]
         gsub => [
            "countryname", "Country Name:", ""
         ]
         gsub => [
            "dstinterface", ":", ""
         ]
         gsub => [
            "srcinterface", ":", ""
         ]
         gsub => [
            "dstport", ":", ""
         ]
         gsub => [
            "srcport", ":", ""
         ]

############################# Produtividade #############################

         gsub => [
            "productivity", "Administrative Custom List settings", "Productive"
         ]
         gsub => [
            "productivity", "Violence/Hate/Racism", "Unacceptable"
         ]
         gsub => [
            "productivity", "Intimate Apparel/Swimsuit", "Unacceptable"
         ]
         gsub => [
            "productivity", "Nudism", "Unacceptable"
         ]
         gsub => [
            "productivity", "Pornography", "Unacceptable"
         ]
         gsub => [
            "productivity", "Weapons", "Unacceptable"
         ]
         gsub => [
            "productivity", "Adult/Mature Content", "Unacceptable"
         ]
         gsub => [
            "productivity", "Cult/Occult", "Unacceptable"
         ]
         gsub => [
            "productivity", "Drugs/Illegal Drugs", "Unacceptable"
         ]
         gsub => [
            "productivity", "Illegal Skills/Questionable Skills", "Unacceptable"
         ]
         gsub => [
            "productivity", "Sex Education", "Unacceptable"
         ]
         gsub => [
            "productivity", "Gambling", "Unacceptable"
         ]
         gsub => [
            "productivity", "Alcohol/Tobacco", "Unacceptable"
         ]
         gsub => [
            "productivity", "Chat/Instant Messaging \(IM\)", "Productive"
         ]
         gsub => [
            "productivity", "Arts/Entertainment", "Unproductive"
         ]
         gsub => [
            "productivity", "Business and Economy", "Productive"
         ]
         gsub => [
            "productivity", "Abortion/Advocacy Groups", "Unproductive"
         ]
         gsub => [
            "productivity", "Education", "Acceptable"
         ]
         gsub => [
            "productivity", "Cultural Institutions", "Unproductive"
         ]
         gsub => [
            "productivity", "Online Banking", "Productive"
         ]
         gsub => [
            "productivity", "Online Brokerage and Trading", "Acceptable"
         ]
         gsub => [
            "productivity", "Games", "Unacceptable"
         ]
         gsub => [
            "productivity", "Government", "Productive"
         ]
         gsub => [
            "productivity", "Military", "Unproductive"
         ]
         gsub => [
            "productivity", "Political/Advocacy Groups", "Unproductive"
         ]
         gsub => [
            "productivity", "Health", "Acceptable"
         ]
         gsub => [
            "productivity", "Information Technology/Computers", "Acceptable"
         ]
         gsub => [
            "productivity", "Hacking/Proxy Avoidance Systems", "Unacceptable"
         ]
         gsub => [
            "productivity", "Search Engines and Portals", "Acceptable"
         ]
         gsub => [
            "productivity", "E-Mail", "Acceptable"
         ]
         gsub => [
            "productivity", "Web Communications", "Unproductive"
         ]
         gsub => [
            "productivity", "Job Search", "Acceptable"
         ]
         gsub => [
            "productivity", "News and Media", "Unproductive"
         ]
         gsub => [
            "productivity", "Personals and Dating", "Unproductive"
         ]
         gsub => [
            "productivity", "Usenet News Groups", "Unproductive"
         ]
         gsub => [
            "productivity", "Reference", "Unproductive"
         ]
         gsub => [
            "productivity", "Religion", "Unproductive"
         ]
         gsub => [
            "productivity", "Shopping", "Acceptable"
         ]
         gsub => [
            "productivity", "Internet Auctions", "Unproductive"
         ]
         gsub => [
            "productivity", "Real Estate", "Unproductive"
         ]
         gsub => [
            "productivity", "Society and Lifestyle", "Unproductive"
         ]
         gsub => [
            "productivity", "Restaurants and Dining", "Unproductive"
         ]
         gsub => [
            "productivity", "Sports/Recreation", "Unproductive"
         ]
         gsub => [
            "productivity", "Travel", "Unproductive"
         ]
         gsub => [
            "productivity", "Vehicles", "Unproductive"
         ]
         gsub => [
            "productivity", "Humor/Jokes", "Unproductive"
         ]
         gsub => [
            "productivity", "Multimedia", "Unproductive"
         ]
         gsub => [
            "productivity", "Freeware/Software Downloads", "Unacceptable"
         ]
         gsub => [
            "productivity", "Pay to Surf Sites", "Unproductive"
         ]
         gsub => [
            "productivity", "Kid Friendly", "Unproductive"
         ]
         gsub => [
            "productivity", "Advertisement", "Unacceptable"
         ]
         gsub => [
            "productivity", "Web Hosting", "Unacceptable"
         ]
         gsub => [
            "productivity", "Other", "Unproductive"
         ]
         gsub => [
            "productivity", "Internet Watch Foundation CAIC", "Unproductive"
         ]
         gsub => [
            "productivity", "Social Networking", "Unproductive"
         ]
         gsub => [
            "productivity", "Malware", "Unacceptable"
         ]
         gsub => [
            "productivity", "Radicalization and Extremism", "Unacceptable"
         ]

############################# Site Clean #############################

############################# facebook.com #############################

         gsub => [
            "dstname", "scontent([a-zA-Z0-9 -.]+).fbcdn.net", "facebook.com"
         ]
         gsub => [
            "dstname", "video([a-zA-Z0-9 -.]+).fbcdn.net", "facebook.com"
         ]
         gsub => [
            "dstname", "external([a-zA-Z0-9 -.]+).facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "video([a-zA-Z0-9 -.]+).facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "scontent([a-zA-Z0-9 -.]+).facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).fbsbx.com", "facebook.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).messenger.com", "facebook.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)sonar([a-zA-Z0-9 -.]+).fbcdn.net", "facebook.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)sonar([a-zA-Z0-9 -.]+).facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "www.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "connect.facebook.net", "facebook.com"
         ]
         gsub => [
            "dstname", "edge-chat.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "web.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "facebook.com.br", "facebook.com"
         ]
         gsub => [
            "dstname", "pt-br.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "l.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "graph.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "m.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "pixel.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "fbcdn.net", "facebook.com"
         ]
         gsub => [
            "dstname", "static.xx.fbcdn.net", "facebook.com"
         ]
         gsub => [
            "dstname", "static.xx.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "connect.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "fbsbx.com", "facebook.com"
         ]
         gsub => [
            "dstname", "an.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "upload.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "hi-in.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "en-gb.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "error.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "apps.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "es-la.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "api.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "lookaside.facebook.com", "facebook.com"
         ]
         gsub => [
            "dstname", "cdn.facebook.com", "facebook.com"
         ]

############################# instagram.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).instagram.com", "instagram.com"
         ]
         gsub => [
            "dstname", "instagram.([a-zA-Z0-9 -.]+).fbcdn.net", "instagram.com"
         ]
         gsub => [
            "dstname", "instagram.([a-zA-Z0-9 -.]+).facebook.com", "instagram.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).cdninstagram.com", "instagram.com"
         ]

############################# whatsapp.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).whatsapp.com", "whatsapp.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).whatsapp.net", "whatsapp.com"
         ]

############################# youtube.com #############################

         gsub => [
            "dstname", "yt3.ggpht.com", "youtube.com"
         ]
         gsub => [
            "dstname", "youtubei.googleapis.com", "youtube.com"
         ]
         gsub => [
            "dstname", "youtube.googleapis.com", "youtube.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).youtube.com", "youtube.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).ytimg.com", "youtube.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).googlevideo.com", "youtube.com"
         ]

############################# windowsupdate.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).windowsupdate.com", "windowsupdate.com"
         ]
         gsub => [
            "dstname", "update.microsoft.com", "windowsupdate.com"
         ]

############################# globo.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).globo.com", "globo.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).globovideos.com", "globo.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).glbimg.com", "globo.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).glbvid.com", "globo.com"
         ]

############################# teams.microsoft.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).teams.microsoft.com", "teams.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).teams.cdn.office.net", "teams.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)teams-ring.msedge.net", "teams.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)teams.live.com", "teams.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)teams.events.data.microsoft.com", "teams.microsoft.com"
         ]

############################# netflix.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).netflix.com", "netflix.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).nflximg.net", "netflix.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).nflximg.com", "netflix.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).nflxext.com", "netflix.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).nflxvideo.net", "netflix.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).nflxso.net", "netflix.com"
         ]

############################# twitter.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).twitter.com", "twitter.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).twimg.com", "twitter.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).pscp.tv", "twitter.com"
         ]

############################# tiktok.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).tiktok.com", "tiktok.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).tiktokv.com", "tiktok.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).tiktokcdn.com", "tiktok.com"
         ]

############################# kwai.net #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).kwai.net", "kwai.net"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)yximgs.com", "kwai.net"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)kwai-pro.com", "kwai.net"
         ]

############################# linkedin.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).linkedin.com", "linkedin.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).licdn.com", "linkedin.com"
         ]

############################# bitdefender.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).bitdefender.com", "bitdefender.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)bitdefender.net", "bitdefender.com"
         ]

############################# skype.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).skype.com", "skype.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)skypeassets.com", "skype.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).messenger.live.com", "skype.com"
         ]

############################# apple.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).apple.com", "apple.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).cdn-apple.com", "apple.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).icloud.com", "apple.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).icloud-content.com", "apple.com"
         ]

############################# spotify.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).spotify.com", "spotify.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)spotify-com.akamaized.net", "spotify.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)scdn.co", "spotify.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)spotify.com.akamaized.net", "spotify.com"
         ]

############################# sharepoint.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).aa-rt.sharepoint.com", "sharepoint.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).sharepointonline.com", "sharepoint.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)signout.sharepoint.com", "sharepoint.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).sharepoint-df.com", "sharepoint.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).sharepoint.de", "sharepoint.com"
         ]

############################# mercadolivre.com.br #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).mercadolivre.com.br", "mercadolivre.com.br"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).mlstatic.com", "mercadolivre.com.br"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).mercadolibre.com", "mercadolivre.com.br"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).mercadolivre.com", "mercadolivre.com.br"
         ]

############################# giphy.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).giphy.com", "giphy.com"
         ]

############################# yahoo.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).yahoomedia.net", "yahoo.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).yimg.com", "yahoo.com"
         ]

############################# uol.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).uol.com.br", "uol.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).imguol.com.br", "uol.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).conteudo.uol", "uol.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).rtlive.uol.com", "uol.com"
         ]

############################# avg.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).avcdn.net", "avg.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).avg.com", "avg.com"
         ]

############################# shopee.com.br #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).shopee.com.br", "shopee.com.br"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).shopeemobile.com", "shopee.com.br"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).shopee.sg", "shopee.com.br"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)shopee.com", "shopee.com.br"
         ]

############################# cdn.gvt.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).gvt1.com", "cdn.gvt.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).gvt2.com", "cdn.gvt.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).gvt3.com", "cdn.gvt.com"
         ]

############################# twitch.tv #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).twitch.tv", "twitch.tv"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)ttvnw.net", "twitch.tv"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)twitchcdn.net", "twitch.tv"
         ]

############################# vimeo.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).vimeo.com", "vimeo.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)vimeocdn.com", "vimeo.com"
         ]

############################# outlook.microsoft.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)outlook.com", "outlook.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)outlook.live.com", "outlook.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)outlook.live.net", "outlook.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)outlookmobile-office365-tas.msedge.net", "outlook.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)outlook.office365.com", "outlook.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)outlook.office.com", "outlook.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)outlookmobile.com", "outlook.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)outlook-1.cdn.office.net", "outlook.microsoft.com"
         ]

############################# office.microsoft.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)office.net", "office.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)officeapps.live.com", "office.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)office365.com", "office.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)officecdn-microsoft-com.akamaized.net", "office.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)office.microsoft.com", "office.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)officecdn.microsoft.com.edgesuite.net", "office.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)officecdn.microsoft.com", "office.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)officeclient.microsoft.com", "office.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)appsforoffice.microsoft.com", "office.microsoft.com"
         ]


############################# edge.microsoft.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).edgesuite.net", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)ring.msedge.net", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)ieonline.microsoft.com", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)fallback.msedge.net", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)fp.msedge.net", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)fpc.msedge.net", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)eafddirect.msedge.net", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)evoke-windowsservices-tas.msedge.net", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)smartscreen.microsoft.com", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)smartscreen-prod.microsoft.com", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)browser.events.data.microsoft.com", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)ieonlinews.microsoft.com", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)msedge.api.cdp.microsoft.com", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)iecvlist.microsoft.com", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)edgewelcomecdn.microsoft.com", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)microsoftedgewelcome.microsoft.com", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)edge.activity.windows.com", "edge.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)edge-enterprise.activity.windows.com", "edge.microsoft.com"
         ]


############################# bing.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).bing.com", "bing.com"
         ]

############################# onedrive.microsoft.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)onedrive.live.com", "onedrive.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)storage.live.com", "onedrive.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)skydrive.wns.windows.com", "onedrive.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)client.wns.windows.com", "onedrive.microsoft.com"
         ]

############################# msn.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).msn.com", "msn.com"
         ]

############################# xbox.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).xboxlive.com", "xbox.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).xbox.com", "xbox.com"
         ]

############################# store.microsoft.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)store.microsoft.com", "store.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)storequality.microsoft.com", "store.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)store-images.s-microsoft.com", "store.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)mp.microsoft.com", "store.microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)apps.microsoft.com", "store.microsoft.com"
         ]

############################# microsoft.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).pipe.aria.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)graph.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)urs.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)events.data.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)c.urs.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)weather.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)go.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)microsoft-com.akamaized.net", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)checkappexec.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)vortex.data.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)telecommandsvc.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)settings-win.data.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)iris.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)www.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)fs.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)crl.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)weather.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)dds.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)metaservices.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)oneocsp.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)settings.data.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)metaservices.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)urs.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)admin.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)wdcp.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)support.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)i.s-microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)cxcs.microsoft.net", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)wcpstatic.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)cs.dds.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)t.urs.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)msdl.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)uif.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)emdl.ws.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)csp.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)fpt.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)compass-ssl.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)telemetry.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)graph.print.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)prod.cms.rt.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)mam.manage.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)vortex-win.data.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)sls.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)share.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)core.bdec.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)fe2.ws.microsoft.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)activity.windows.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)wns.windows.com", "microsoft.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)adl.windows.com", "microsoft.com"
         ]

############################# symantec.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)symantecliveupdate.com", "symantec.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).symantec.com", "symantec.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)norton.com", "symantec.com"
         ]

############################# thomsonreuters.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).thomsonreuters.com", "thomsonreuters.com"
         ]

############################# dropbox.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).dropbox.com", "dropbox.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)dropboxusercontent.com", "dropbox.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)dropboxstatic.com", "dropbox.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)dropboxapi.com", "dropbox.com"
         ]

############################# avast.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).avast.com", "avast.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)avastbrowser.com", "avast.com"
         ]

############################# krux.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).krux.com", "krux.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)krxd.net", "krux.com"
         ]

############################# opera.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).opera.com", "opera.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)operacdn.com", "opera.com"
         ]

############################# mcafee.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).mcafee.com", "mcafee.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)mcafeewebadvisor.com", "mcafee.com"
         ]

############################# snapchat.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).snapchat.com", "snapchat.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)snaptube.app", "snapchat.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)snaptube.in", "snapchat.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)snaptubeapp.com", "snapchat.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)snappea.com", "snapchat.com"
         ]

############################# investing.com #############################

         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).investing.com", "investing.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)forexpros.com", "investing.com"
         ]

############################# ubuntu.com #############################
         
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).ubuntu.com", "ubuntu.com"
         ]

############################# xiaomi.com #############################
         
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).xiaomi.com", "xiaomi.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)mi-img.comt", "xiaomi.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)xiaomi.net", "xiaomi.com"
         ]

############################# samsungapps.com #############################
         
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).samsungapps.com", "samsungapps.com"
         ]

############################# hurb.com #############################
         
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+).hurb.com", "hurb.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)hotelurbano.net", "hurb.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)hotelurbano.com", "hurb.com"
         ]
         gsub => [
            "dstname", "([a-zA-Z0-9 -.]+)ghucdn.net", "hurb.com"
         ]

      }
      mutate {
         convert => {
            "rcvd" => "integer"
            "sent" => "integer"
            "dur"  => "integer"
         }
      }
   }
}
output {
if [type] == "sonicwall" {
  elasticsearch {
    hosts => ["http://IP-DO-ELASTICSEACRH:9200"]
    index => "sonicwall-%{+YYYY.MM.dd}"
    user => "logstash"
    password => "MESMASENHAAUTOGERADAUSERlogstash_system"
    }
  }
}
